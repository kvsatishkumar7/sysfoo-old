name: sysfoo-ci-pipeline
on: push

jobs: 
   build-sysfoo:
     runs-on: ubuntu-latest
     permissions:
            contents: read
            packages: write
  
     steps:
        - name: Code checkout or code clone
          uses: actions/checkout@v5

        - name: Run mvn test
          run: mvn test
        
        - name: Run mvn clean & package
          run: mvn clean package
        
        - name: Run ls command
          run: ls -lrt
        
        - name: Upload artifact in Github registry
          uses: actions/upload-artifact@v4
          with:
             name: sysfoo
             path: target/sysfoo.war

        - uses: actions/setup-java@v4
          with:
             java-version: '11'
             distribution: 'temurin'

        - name: Publish package
          run: mvn --batch-mode deploy
          env:
             GITHUB_TOKEN: ${{ secrets. GITHUB_TOKEN }}

